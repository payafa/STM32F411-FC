/*
 * BMP280.h
 *
 * BMP280????????????
 * ????STM32F411CEU6??BMP280?????
 *
 * ??????????????
 */

#ifndef BMP280_H
#define BMP280_H

#include "I2C.h"

/* ???? */
#define BMP280_ADDR             0xEC        // BMP280 I2C???
#define BMP280_WHO_AM_I_REG     0xD0        // WHO_AM_I????????
#define BMP280_WHO_AM_I_VAL     0x58        // WHO_AM_I?

/* ???????????? */
#define BMP280_TEMP_XLSB_REG     0xFC        // ????????§¹¦Ë
#define BMP280_TEMP_LSB_REG      0xFB        // ??????§¹¦Ë
#define BMP280_TEMP_MSB_REG      0xFA        // ??????§¹¦Ë
#define BMP280_PRESS_XLSB_REG    0xF9        // ????????§¹¦Ë
#define BMP280_PRESS_LSB_REG     0xF8        // ???????§¹¦Ë
#define BMP280_PRESS_MSB_REG     0xF7        // ???????§¹¦Ë
#define BMP280_CONFIG_REG        0xF5        // ????
#define BMP280_CTRL_MEAS_REG     0xF4        // ???????
#define BMP280_STATUS_REG        0xF3        // ??
#define BMP280_RESET_REG         0xE0        // ??¦Ë

/* §µ?????????? */
#define BMP280_DIG_T1_LSB_REG    0x88        // ???§µ?????T1?????
#define BMP280_DIG_T1_MSB_REG    0x89        // ???§µ?????T1?????
#define BMP280_DIG_T2_LSB_REG    0x8A        // ???§µ?????T2?????
#define BMP280_DIG_T2_MSB_REG    0x8B        // ???§µ?????T2?????
#define BMP280_DIG_T3_LSB_REG    0x8C        // ???§µ?????T3?????
#define BMP280_DIG_T3_MSB_REG    0x8D        // ???§µ?????T3?????
#define BMP280_DIG_P1_LSB_REG    0x8E        // ???§µ?????P1?????
#define BMP280_DIG_P1_MSB_REG    0x8F        // ???§µ?????P1?????
#define BMP280_DIG_P2_LSB_REG    0x90        // ???§µ?????P2?????
#define BMP280_DIG_P2_MSB_REG    0x91        // ???§µ?????P2?????
#define BMP280_DIG_P3_LSB_REG    0x92        // ???§µ?????P3?????
#define BMP280_DIG_P3_MSB_REG    0x93        // ???§µ?????P3?????
#define BMP280_DIG_P4_LSB_REG    0x94        // ???§µ?????P4?????
#define BMP280_DIG_P4_MSB_REG    0x95        // ???§µ?????P4?????
#define BMP280_DIG_P5_LSB_REG    0x96        // ???§µ?????P5?????
#define BMP280_DIG_P5_MSB_REG    0x97        // ???§µ?????P5?????
#define BMP280_DIG_P6_LSB_REG    0x98        // ???§µ?????P6?????
#define BMP280_DIG_P6_MSB_REG    0x99        // ???§µ?????P6?????
#define BMP280_DIG_P7_LSB_REG    0x9A        // ???§µ?????P7?????
#define BMP280_DIG_P7_MSB_REG    0x9B        // ???§µ?????P7?????
#define BMP280_DIG_P8_LSB_REG    0x9C        // ???§µ?????P8?????
#define BMP280_DIG_P8_MSB_REG    0x9D        // ???§µ?????P8?????
#define BMP280_DIG_P9_LSB_REG    0x9E        // ???§µ?????P9?????
#define BMP280_DIG_P9_MSB_REG    0x9F        // ???§µ?????P9?????

/* ????????? */
typedef struct {
    uint16_t dig_T1;  // ???§µ?????T1
    int16_t  dig_T2;  // ???§µ?????T2
    int16_t  dig_T3;  // ???§µ?????T3
    uint16_t dig_P1;  // ???§µ?????P1
    int16_t  dig_P2;  // ???§µ?????P2
    int16_t  dig_P3;  // ???§µ?????P3
    int16_t  dig_P4;  // ???§µ?????P4
    int16_t  dig_P5;  // ???§µ?????P5
    int16_t  dig_P6;  // ???§µ?????P6
    int16_t  dig_P7;  // ???§µ?????P7
    int16_t  dig_P8;  // ???§µ?????P8
    int16_t  dig_P9;  // ???§µ?????P9
} BMP280_CalibData_t;

typedef struct {
    uint32_t press;   // ??????
    uint32_t temp;    // ??????
} BMP280_RawData_t;

typedef struct {
    float press;      // ???? (hPa)
    float temp;       // ???? (??C)
    float altitude;   // ???¦È?? (m)
} BMP280_Data_t;

/* ???????? */
uint8_t BMP280_Init(void);
uint8_t BMP280_Check(void);
void BMP280_ReadRawData(BMP280_RawData_t *data);
void BMP280_ReadData(BMP280_Data_t *data);
void BMP280_ReadCalibData(void);

#endif /* BMP280_H */
